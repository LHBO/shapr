<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Set up the framework chosen approach — setup_approach • shapr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Set up the framework chosen approach — setup_approach"><meta property="og:description" content="The different choices of approach takes different (optional) parameters,
which are forwarded from explain()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shapr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.9200</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/understanding_shapr.html">General usage of shapr</a>
    </li>
    <li>
      <a href="../articles/understanding_shapr_vaeac.html">Advanced usage of the `vaeac` approach</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NorskRegnesentral/shapr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set up the framework chosen approach</h1>
    <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/approach.R" class="external-link"><code>R/approach.R</code></a>, <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/approach_categorical.R" class="external-link"><code>R/approach_categorical.R</code></a>, <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/approach_copula.R" class="external-link"><code>R/approach_copula.R</code></a>, and 6 more</small>
    <div class="hidden name"><code>setup_approach.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The different choices of <code>approach</code> takes different (optional) parameters,
which are forwarded from <code><a href="explain.html">explain()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_approach</span><span class="op">(</span><span class="va">internal</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for categorical</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span></span>
<span>  <span class="va">internal</span>,</span>
<span>  categorical.joint_prob_dt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  categorical.epsilon <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for copula</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span><span class="va">internal</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ctree</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span></span>
<span>  <span class="va">internal</span>,</span>
<span>  ctree.mincriterion <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  ctree.minsplit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  ctree.minbucket <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  ctree.sample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for empirical</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span></span>
<span>  <span class="va">internal</span>,</span>
<span>  empirical.type <span class="op">=</span> <span class="st">"fixed_sigma"</span>,</span>
<span>  empirical.eta <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  empirical.fixed_sigma <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  empirical.n_samples_aicc <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  empirical.eval_max_aicc <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  empirical.start_aicc <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  empirical.cov_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gaussian</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span><span class="va">internal</span>, gaussian.mu <span class="op">=</span> <span class="cn">NULL</span>, gaussian.cov_mat <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for independence</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span><span class="va">internal</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for timeseries</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span></span>
<span>  <span class="va">internal</span>,</span>
<span>  timeseries.fixed_sigma_vec <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  timeseries.bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for vaeac</span></span>
<span><span class="fu">setup_approach</span><span class="op">(</span></span>
<span>  <span class="va">internal</span>,</span>
<span>  vaeac.depth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  vaeac.width <span class="op">=</span> <span class="fl">32</span>,</span>
<span>  vaeac.latent_dim <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  vaeac.activation_function <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/torch/man/nn_relu.html" class="external-link">nn_relu</a></span>,</span>
<span>  vaeac.lr <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  vaeac.n_vaeacs_initialize <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  vaeac.epochs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  vaeac.extra_parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>internal</dt>
<dd><p>Not used.</p></dd>


<dt>...</dt>
<dd><p><code>approach</code>-specific arguments. See below.</p></dd>


<dt>categorical.joint_prob_dt</dt>
<dd><p>Data.table. (Optional)
Containing the joint probability distribution for each combination of feature
values.
<code>NULL</code> means it is estimated from the <code>x_train</code> and <code>x_explain</code>.</p></dd>


<dt>categorical.epsilon</dt>
<dd><p>Numeric value. (Optional)
If <code>joint_probability_dt</code> is not supplied, probabilities/frequencies are
estimated using <code>x_train</code>. If certain observations occur in <code>x_train</code> and NOT in <code>x_explain</code>,
then epsilon is used as the proportion of times that these observations occurs in the training data.
In theory, this proportion should be zero, but this causes an error later in the Shapley computation.</p></dd>


<dt>ctree.mincriterion</dt>
<dd><p>Numeric scalar or vector. (default = 0.95)
Either a scalar or vector of length equal to the number of features in the model.
Value is equal to 1 - \(\alpha\) where \(\alpha\) is the nominal level of the conditional independence tests.
If it is a vector, this indicates which value to use when conditioning on various numbers of features.</p></dd>


<dt>ctree.minsplit</dt>
<dd><p>Numeric scalar. (default = 20)
Determines minimum value that the sum of the left and right daughter nodes required for a split.</p></dd>


<dt>ctree.minbucket</dt>
<dd><p>Numeric scalar. (default = 7)
Determines the minimum sum of weights in a terminal node required for a split</p></dd>


<dt>ctree.sample</dt>
<dd><p>Boolean. (default = TRUE)
If TRUE, then the method always samples <code>n_samples</code> observations from the leaf nodes (with replacement).
If FALSE and the number of observations in the leaf node is less than <code>n_samples</code>,
the method will take all observations in the leaf.
If FALSE and the number of observations in the leaf node is more than <code>n_samples</code>,
the method will sample <code>n_samples</code> observations (with replacement).
This means that there will always be sampling in the leaf unless
<code>sample</code> = FALSE AND the number of obs in the node is less than <code>n_samples</code>.</p></dd>


<dt>empirical.type</dt>
<dd><p>Character. (default = <code>"fixed_sigma"</code>)
Should be equal to either <code>"independence"</code>,<code>"fixed_sigma"</code>, <code>"AICc_each_k"</code> <code>"AICc_full"</code>.
TODO: Describe better what the methods do here.</p></dd>


<dt>empirical.eta</dt>
<dd><p>Numeric. (default = 0.95)
Needs to be <code>0 &lt; eta &lt;= 1</code>.
Represents the minimum proportion of the total empirical weight that data samples should use.
If e.g. <code>eta = .8</code> we will choose the <code>K</code> samples with the largest weight so that the sum of the weights
accounts for 80\<!-- % of the total weight. -->
<code>eta</code> is the \(\eta\) parameter in equation (15) of Aas et al (2021).</p></dd>


<dt>empirical.fixed_sigma</dt>
<dd><p>Positive numeric scalar. (default = 0.1)
Represents the kernel bandwidth in the distance computation used when conditioning on all different combinations.
Only used when <code>empirical.type = "fixed_sigma"</code></p></dd>


<dt>empirical.n_samples_aicc</dt>
<dd><p>Positive integer. (default = 1000)
Number of samples to consider in AICc optimization.
Only used for <code>empirical.type</code> is either <code>"AICc_each_k"</code> or <code>"AICc_full"</code>.</p></dd>


<dt>empirical.eval_max_aicc</dt>
<dd><p>Positive integer. (default = 20)
Maximum number of iterations when optimizing the AICc.
Only used for <code>empirical.type</code> is either <code>"AICc_each_k"</code> or <code>"AICc_full"</code>.</p></dd>


<dt>empirical.start_aicc</dt>
<dd><p>Numeric. (default = 0.1)
Start value of the <code>sigma</code> parameter when optimizing the AICc.
Only used for <code>empirical.type</code> is either <code>"AICc_each_k"</code> or <code>"AICc_full"</code>.</p></dd>


<dt>empirical.cov_mat</dt>
<dd><p>Numeric matrix. (Optional, default = NULL)
Containing the covariance matrix of the data generating distribution used to define the Mahalanobis distance.
<code>NULL</code> means it is estimated from <code>x_train</code>.</p></dd>


<dt>model</dt>
<dd><p>Objects.
The model object that ought to be explained.
See the documentation of <code><a href="explain.html">explain()</a></code> for details.</p></dd>


<dt>predict_model</dt>
<dd><p>Function.
The prediction function used when <code>model</code> is not natively supported.
See the documentation of <code><a href="explain.html">explain()</a></code> for details.</p></dd>


<dt>gaussian.mu</dt>
<dd><p>Numeric vector. (Optional)
Containing the mean of the data generating distribution.
<code>NULL</code> means it is estimated from the <code>x_train</code>.</p></dd>


<dt>gaussian.cov_mat</dt>
<dd><p>Numeric matrix. (Optional)
Containing the covariance matrix of the data generating distribution.
<code>NULL</code> means it is estimated from the <code>x_train</code>.</p></dd>


<dt>timeseries.fixed_sigma_vec</dt>
<dd><p>Numeric. (Default = 2)
Represents the kernel bandwidth in the distance computation. TODO: What length should it have? 1?</p></dd>


<dt>timeseries.bounds</dt>
<dd><p>Numeric vector of length two. (Default = c(NULL, NULL))
If one or both of these bounds are not NULL, we restrict the sampled time series to be
between these bounds.
This is useful if the underlying time series are scaled between 0 and 1, for example.</p></dd>


<dt>vaeac.depth</dt>
<dd><p>Positive integer (default is <code>3</code>). The number of hidden layers
in the neural networks of the masked encoder, full encoder, and decoder.</p></dd>


<dt>vaeac.width</dt>
<dd><p>Positive integer (default is <code>32</code>). The number of neurons in each
hidden layer in the neural networks of the masked encoder, full encoder, and decoder.</p></dd>


<dt>vaeac.latent_dim</dt>
<dd><p>Positive integer (default is <code>8</code>). The number of dimensions in the latent space.</p></dd>


<dt>vaeac.activation_function</dt>
<dd><p>An <code><a href="https://rdrr.io/pkg/torch/man/nn_module.html" class="external-link">torch::nn_module()</a></code> representing an activation function such as, e.g.,
<code><a href="https://rdrr.io/pkg/torch/man/nn_relu.html" class="external-link">torch::nn_relu()</a></code> (default), <code><a href="https://rdrr.io/pkg/torch/man/nn_leaky_relu.html" class="external-link">torch::nn_leaky_relu()</a></code>, <code><a href="https://rdrr.io/pkg/torch/man/nn_selu.html" class="external-link">torch::nn_selu()</a></code>, or <code><a href="https://rdrr.io/pkg/torch/man/nn_sigmoid.html" class="external-link">torch::nn_sigmoid()</a></code>.</p></dd>


<dt>vaeac.lr</dt>
<dd><p>Positive numeric (default is <code>0.001</code>). The learning rate used in the <code><a href="https://rdrr.io/pkg/torch/man/optim_adam.html" class="external-link">torch::optim_adam()</a></code> optimizer.</p></dd>


<dt>vaeac.n_vaeacs_initialize</dt>
<dd><p>Positive integer (default is <code>4</code>). The number of different vaeac models to initiate
in the start. Pick the best performing one after <code>vaeac.extra_parameters$epochs_initiation_phase</code>
epochs (default is <code>2</code>) and continue training that one.</p></dd>


<dt>vaeac.epochs</dt>
<dd><p>Positive integer (default is <code>100</code>). The number of epochs to train the final vaeac model.
This includes <code>vaeac.extra_parameters$epochs_initiation_phase</code>, where the default is <code>2</code>.</p></dd>


<dt>vaeac.extra_parameters</dt>
<dd><p>Named list with extra parameters to the <code>vaeac</code> approach. See
<code><a href="vaeac_get_extra_para_default.html">vaeac_get_extra_para_default()</a></code> for description of possible additional parameters and their default values.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Martin Jullum</p>
<p>Lars Henry Berge Olsen</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolai Sellereite, Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Norsk Regnesentral.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

